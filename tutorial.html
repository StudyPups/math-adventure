<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vine Rescue Tutorial - StudyPups</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body class="practice-page forest-background">
    
    <div class="tutorial-container">
        <!-- Story Introduction -->
        <div class="story-panel" id="story-panel">
            <div class="fairy-avatar">ğŸ§šâ€â™€ï¸</div>
            <div class="story-dialogue">
                <p id="story-text">
                    <strong>Oh no!</strong> I'm tangled in these vines!<br>
                    Can you help me by solving these pattern puzzles?<br>
                    Each correct answer will break one vine!
                </p>
            </div>
            <button class="primary-btn" onclick="startTutorial()">I'll help you! ğŸŒŸ</button>
        </div>

        <!-- Tutorial Game Area (hidden initially) -->
        <div class="tutorial-game" id="tutorial-game" style="display: none;">
            
            <div class="vine-visual" id="vine-visual">
                <div class="fairy-trapped">ğŸ§šâ€â™€ï¸</div>
                <div class="vines-container">
                    <div class="vine active" data-vine="1">ğŸŒ¿</div>
                    <div class="vine active" data-vine="2">ğŸŒ¿</div>
                    <div class="vine active" data-vine="3">ğŸŒ¿</div>
                    <div class="vine active" data-vine="4">ğŸŒ¿</div>
                    <div class="vine active" data-vine="5">ğŸŒ¿</div>
                </div>
                <div class="vines-remaining" id="vines-remaining">5 vines left!</div>
            </div>

            <div class="tutorial-question-area">
                <div class="tutorial-helper">
                    <div class="teddy-small">ğŸ•</div>
                    <div class="helper-text" id="helper-text">
                        <p>Welcome! I'm Teddy! If you get stuck, click the ğŸ’ gem to ask me for help!</p>
                    </div>
                </div>

                <div class="gem-tutorial">
                    <button class="gem active" id="tutorial-gem" onclick="showTutorialHint()">ğŸ’</button>
                    <div class="gem-energy-bar">
                        <div class="gem-energy-fill" id="tutorial-gem-energy"></div>
                    </div>
                    <div class="gem-label">Ask Teddy!</div>
                </div>

                <div class="question-card">
                    <div class="question-number">Puzzle <span id="puzzle-num">1</span> of 5</div>
                    <div class="question-text" id="tutorial-question"></div>
                    <div class="answer-options" id="tutorial-options"></div>
                    <div class="feedback" id="tutorial-feedback"></div>
                </div>
            </div>
        </div>

        <!-- Completion -->
        <div class="tutorial-complete" id="tutorial-complete" style="display: none;">
            <div class="fairy-free">ğŸ§šâ€â™€ï¸âœ¨</div>
            <h1>You Did It!</h1>
            <p>Thank you for saving me! Now you know how to play!</p>
            <div class="tutorial-tips">
                <h3>Remember:</h3>
                <ul>
                    <li>ğŸ’ Click the gem when you need help</li>
                    <li>ğŸ• Teddy will give you hints</li>
                    <li>âœ¨ The gem refills automatically</li>
                    <li>ğŸ¯ Solve questions to find StudyPups!</li>
                </ul>
            </div>
            <button class="game-button" onclick="window.location.href='patterns.html'">Start the Real Adventure! ğŸŒŸ</button>
            <button class="game-button-secondary" onclick="window.location.href='index.html'">Back to Start</button>
        </div>
    </div>

    <script>
        // Simple tutorial questions
        const tutorialQuestions = [
            {
                question: "Let's start easy! What comes next?\n2, 4, 6, 8, __",
                options: ["9", "10", "11", "12"],
                correct: 1,
                hints: [
                    "Look at how much each number goes up by!",
                    "The pattern adds 2 each time: 2, 4 (+2), 6 (+2), 8 (+2)...",
                    "8 + 2 = 10"
                ]
            },
            {
                question: "Great! Now try this:\n5, 10, 15, 20, __",
                options: ["22", "25", "30", "24"],
                correct: 1,
                hints: [
                    "These are counting by 5s!",
                    "5, 10 (+5), 15 (+5), 20 (+5)...",
                    "20 + 5 = 25"
                ]
            },
            {
                question: "You're doing great! What's missing?\n10, 20, __, 40, 50",
                options: ["25", "30", "35", "32"],
                correct: 1,
                hints: [
                    "This pattern counts by 10s.",
                    "10, 20 (+10), then add 10 again...",
                    "20 + 10 = 30"
                ]
            },
            {
                question: "Almost there! Complete this:\n1, 2, 4, 8, __",
                options: ["10", "12", "16", "14"],
                correct: 2,
                hints: [
                    "This pattern is doubling (multiplying by 2)!",
                    "1Ã—2=2, 2Ã—2=4, 4Ã—2=8...",
                    "8 Ã— 2 = 16"
                ]
            },
            {
                question: "Last one! You've got this:\n3, 6, 9, 12, __",
                options: ["13", "14", "15", "16"],
                correct: 2,
                hints: [
                    "This pattern adds 3 each time!",
                    "3, 6 (+3), 9 (+3), 12 (+3)...",
                    "12 + 3 = 15"
                ]
            }
        ];

        let currentPuzzle = 0;
        let gemEnergy = 100;
        let vinesRemaining = 5;
        let currentHintLevel = 0;

        function startTutorial() {
            document.getElementById('story-panel').style.display = 'none';
            document.getElementById('tutorial-game').style.display = 'grid';
            loadTutorialQuestion();
        }

        function loadTutorialQuestion() {
            const q = tutorialQuestions[currentPuzzle];
            document.getElementById('puzzle-num').textContent = currentPuzzle + 1;
            document.getElementById('tutorial-question').textContent = q.question;
            
            const optionsHtml = q.options.map((option, index) => 
                `<button class="answer-option" onclick="checkTutorialAnswer(${index})">${option}</button>`
            ).join('');
            
            document.getElementById('tutorial-options').innerHTML = optionsHtml;
            document.getElementById('tutorial-feedback').innerHTML = '';
            currentHintLevel = 0;
            
            updateGemDisplay();
        }

        function showTutorialHint() {
            if (gemEnergy < 20) {
                document.getElementById('helper-text').innerHTML = 
                    '<p>The gem is recharging! Watch it fill back up automatically... â³</p>';
                return;
            }

            const q = tutorialQuestions[currentPuzzle];
            const hint = q.hints[Math.min(currentHintLevel, q.hints.length - 1)];
            
            gemEnergy -= 20;
            updateGemDisplay();
            currentHintLevel++;
            
            document.getElementById('helper-text').innerHTML = 
                `<p><strong>Teddy's Hint:</strong><br>${hint}</p>`;
        }

        function checkTutorialAnswer(selected) {
            const q = tutorialQuestions[currentPuzzle];
            const feedback = document.getElementById('tutorial-feedback');
            const options = document.querySelectorAll('.answer-option');
            
            options.forEach(opt => opt.disabled = true);
            
            if (selected === q.correct) {
                options[selected].classList.add('correct');
                feedback.innerHTML = '<div class="correct-feedback">âœ¨ Perfect! One vine breaks free! âœ¨</div>';
                document.getElementById('helper-text').innerHTML = '<p>Great job! You\'re a natural! ğŸ‰</p>';
                
                // Break a vine
                breakVine();
                
                // Restore some gem energy
                gemEnergy = Math.min(100, gemEnergy + 20);
                updateGemDisplay();
                
                setTimeout(() => {
                    currentPuzzle++;
                    if (currentPuzzle < tutorialQuestions.length) {
                        loadTutorialQuestion();
                    } else {
                        completeTutorial();
                    }
                }, 2000);
                
            } else {
                options[selected].classList.add('incorrect');
                options[q.correct].classList.add('correct');
                feedback.innerHTML = '<div class="incorrect-feedback">Not quite! Try looking at the pattern again.</div>';
                document.getElementById('helper-text').innerHTML = '<p>That\'s okay! Try clicking the ğŸ’ gem if you need a hint!</p>';
                
                setTimeout(() => {
                    // Reset for retry
                    options.forEach(opt => {
                        opt.disabled = false;
                        opt.classList.remove('incorrect', 'correct');
                    });
                    feedback.innerHTML = '';
                }, 2000);
            }
        }

        function breakVine() {
            const vines = document.querySelectorAll('.vine.active');
            if (vines.length > 0) {
                vines[0].classList.remove('active');
                vines[0].classList.add('broken');
                vines[0].textContent = 'âœ¨';
                vinesRemaining--;
                document.getElementById('vines-remaining').textContent = 
                    vinesRemaining > 0 ? `${vinesRemaining} vines left!` : 'All vines broken!';
            }
        }

        function completeTutorial() {
            localStorage.setItem('studypups-tutorial-complete', 'true');
            document.getElementById('tutorial-game').style.display = 'none';
            document.getElementById('tutorial-complete').style.display = 'flex';
        }

        function updateGemDisplay() {
            const energyFill = document.getElementById('tutorial-gem-energy');
            energyFill.style.width = gemEnergy + '%';
            
            const gem = document.getElementById('tutorial-gem');
            if (gemEnergy >= 20) {
                gem.classList.add('active');
                gem.classList.remove('recharging');
            } else {
                gem.classList.remove('active');
                gem.classList.add('recharging');
            }
        }

        // Auto-regenerate gem
        setInterval(() => {
            if (gemEnergy < 100) {
                gemEnergy = Math.min(100, gemEnergy + 1);
                updateGemDisplay();
            }
        }, 1000);
    </script>
</body>
</html>
