<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pattern Practice - StudyPups</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body class="practice-page forest-background">
    <div class="game-header">
        <button class="home-button" onclick="window.location.href='index.html'" title="Back to Start">üè†</button>
        
        <div class="goal-tracker">
            <h3>Mission: Find the StudyPups!</h3>
            <div class="studypups-collection">
                <div class="pup-slot locked" data-pup="0">
                    <div class="pup-silhouette">üêï</div>
                    <div class="pup-name">???</div>
                </div>
                <div class="pup-slot locked" data-pup="1">
                    <div class="pup-silhouette">üêï</div>
                    <div class="pup-name">???</div>
                </div>
                <div class="pup-slot locked" data-pup="2">
                    <div class="pup-silhouette">üêï</div>
                    <div class="pup-name">???</div>
                </div>
            </div>
        </div>
        
        <div class="gem-container">
            <button class="gem active" id="hint-gem" onclick="useHint()">
                üíé
                <div class="gem-energy-bar">
                    <div class="gem-energy-fill" id="gem-energy"></div>
                </div>
            </button>
            <div class="gem-label">Teddy Hints</div>
        </div>
    </div>

    <div class="practice-container">
        <!-- Question Area -->
        <div class="question-area">
            <div class="question-number">Question <span id="current-q">1</span> of <span id="total-q">15</span></div>
            <div class="question-text" id="question-text"></div>
            <div class="answer-options" id="answer-options"></div>
            <div class="feedback" id="feedback"></div>
        </div>

        <!-- Teddy Helper -->
        <div class="teddy-helper">
            <div class="teddy-avatar">üêï</div>
            <div class="teddy-dialogue" id="teddy-dialogue">
                <p>Let's find those StudyPups! Click on an answer when you're ready!</p>
            </div>
        </div>
    </div>

    <!-- Break Suggestion Modal -->
    <div class="modal" id="break-modal">
        <div class="modal-content">
            <div class="teddy-big">üêï</div>
            <h2>Time for a Brain Break!</h2>
            <p>My tail's getting tired from all this wagging! Let's take a quick break and come back fresh!</p>
            <p class="break-suggestion">Maybe do some:</p>
            <ul>
                <li>üï∫ Dance moves</li>
                <li>üèÉ Star jumps</li>
                <li>üçé Snack time</li>
                <li>üíß Water break</li>
            </ul>
            <button class="game-button" onclick="takeBreak()">Good idea, Teddy!</button>
            <button class="game-button-secondary" onclick="keepGoing()">Just one more question!</button>
        </div>
    </div>

    <!-- Celebration Modal -->
    <div class="modal" id="celebration-modal">
        <div class="modal-content celebration">
            <div class="pup-found" id="pup-avatar"></div>
            <h2 id="pup-greeting"></h2>
            <p id="pup-intro"></p>
            <button class="game-button" onclick="continueAdventure()">Awesome! Let's keep going!</button>
        </div>
    </div>

    <script>
        // Year 6 Pattern & Algebra Questions (NAPLAN style)
        const questions = [
            {
                question: "What is the next number in this pattern?\n3, 6, 9, 12, __",
                options: ["13", "14", "15", "16"],
                correct: 2,
                hint: "Look at how much the numbers go up each time. From 3 to 6 is +3, from 6 to 9 is +3. The pattern adds 3 each time!",
                topic: "Number Patterns"
            },
            {
                question: "Complete the pattern:\n2, 4, 8, 16, __",
                options: ["20", "24", "32", "18"],
                correct: 2,
                hint: "This pattern is doubling! 2√ó2=4, 4√ó2=8, 8√ó2=16. What's 16√ó2?",
                topic: "Multiplication Patterns"
            },
            {
                question: "What number is missing?\n5, 10, __, 20, 25",
                options: ["12", "15", "17", "18"],
                correct: 1,
                hint: "These numbers are counting by 5s! Start at 5, add 5 to get 10, add 5 again to get...",
                topic: "Skip Counting"
            },
            {
                question: "A pattern starts at 100 and decreases by 7 each time.\nWhat are the first four numbers?",
                options: ["100, 93, 86, 79", "100, 97, 94, 91", "100, 90, 80, 70", "100, 95, 90, 85"],
                correct: 0,
                hint: "Start at 100. Decrease means subtract! 100-7=93, 93-7=86, 86-7=79. The pattern goes down by 7!",
                topic: "Decreasing Patterns"
            },
            {
                question: "If the rule is 'multiply by 3', what comes next?\n2, 6, 18, __",
                options: ["21", "36", "54", "24"],
                correct: 2,
                hint: "The rule says multiply by 3! So 2√ó3=6, 6√ó3=18, and 18√ó3=?",
                topic: "Multiplication Rules"
            },
            {
                question: "Complete the pattern:\n1, 4, 9, 16, __\n(These are square numbers)",
                options: ["20", "25", "24", "32"],
                correct: 1,
                hint: "Square numbers mean you multiply a number by itself! 1√ó1=1, 2√ó2=4, 3√ó3=9, 4√ó4=16. What's 5√ó5?",
                topic: "Square Numbers"
            },
            {
                question: "What is the rule for this pattern?\n50, 45, 40, 35, 30",
                options: ["Add 5", "Subtract 5", "Add 10", "Subtract 10"],
                correct: 1,
                hint: "Look at what happens from one number to the next. Does 50 go UP or DOWN to get to 45? By how much?",
                topic: "Pattern Rules"
            },
            {
                question: "If n = 7, what is the value of 3n + 2?",
                options: ["21", "23", "12", "17"],
                correct: 1,
                hint: "n means 7, so replace n with 7! That makes 3√ó7 + 2. Do the multiplication first: 3√ó7=21, then add 2!",
                topic: "Simple Algebra"
            },
            {
                question: "The 5th term in a pattern is 23.\nThe 6th term is 28.\nWhat is the 7th term?",
                options: ["30", "31", "33", "35"],
                correct: 2,
                hint: "From 23 to 28, we added 5. If the pattern keeps going the same way, what do we add to 28?",
                topic: "Finding Terms"
            },
            {
                question: "Which number completes both patterns?\nPattern A: 3, 6, 9, __\nPattern B: 4, 8, __, 16",
                options: ["10", "11", "12", "13"],
                correct: 2,
                hint: "Pattern A counts by 3s (next is 12), Pattern B counts by 4s (next is 12). Both patterns need the same number!",
                topic: "Multiple Patterns"
            },
            {
                question: "A sequence follows the rule: Start at 5, then add 3 each time.\nWhat is the 6th number in the sequence?",
                options: ["18", "20", "23", "17"],
                correct: 1,
                hint: "Let's count: 1st=5, 2nd=8, 3rd=11, 4th=14, 5th=17, 6th=? Keep adding 3!",
                topic: "Sequence Rules"
            },
            {
                question: "What comes next in this pattern?\n1, 3, 7, 15, __",
                options: ["23", "30", "31", "16"],
                correct: 2,
                hint: "Look at the gaps! 1 to 3 (+2), 3 to 7 (+4), 7 to 15 (+8). The gap doubles each time! What's double of 8?",
                topic: "Growing Differences"
            },
            {
                question: "If today is Day 1 and I save $2,\nDay 2 I save $4, Day 3 I save $8...\nHow much will I save on Day 5?",
                options: ["$10", "$16", "$32", "$20"],
                correct: 2,
                hint: "The savings double each day! Day 1=$2, Day 2=$4, Day 3=$8, Day 4=$16, Day 5=?",
                topic: "Real-world Patterns"
            },
            {
                question: "In the pattern 100, 90, 81, 73, 66...\nWhat is happening each time?",
                options: ["Subtracting 10", "Subtracting by increasing amounts", "Dividing by 2", "Subtracting 9"],
                correct: 1,
                hint: "Check each gap: 100-90=10, 90-81=9, 81-73=8, 73-66=7. The amount we subtract decreases by 1 each time!",
                topic: "Complex Patterns"
            },
            {
                question: "If the rule is n + 5 = 12, what is n?",
                options: ["7", "17", "5", "6"],
                correct: 0,
                hint: "n + 5 = 12 means 'what number plus 5 equals 12?' Try: 7+5=12. So n=7!",
                topic: "Solving for n"
            }
        ];

        // Game state
        let currentQuestion = 0;
        let pupsFound = 0;
        let consecutiveHints = 0;
        let gemEnergy = 100;
        let gemCooldown = false;
        let hintsWithoutAttempt = 0;

        // Pups to collect (one every 5 questions)
        const studyPups = [
            { name: "Patches", type: "PatternPup", skill: "Number Patterns", emoji: "üêï‚Äçü¶∫" },
            { name: "Digit", type: "NumPup", skill: "Algebra", emoji: "ü¶Æ" },
            { name: "Sequoia", type: "SequencePup", skill: "Sequences", emoji: "üêï" }
        ];

        function loadQuestion() {
            const q = questions[currentQuestion];
            document.getElementById('current-q').textContent = currentQuestion + 1;
            document.getElementById('total-q').textContent = questions.length;
            document.getElementById('question-text').textContent = q.question;
            
            const optionsHtml = q.options.map((option, index) => 
                `<button class="answer-option" onclick="checkAnswer(${index})">${option}</button>`
            ).join('');
            
            document.getElementById('answer-options').innerHTML = optionsHtml;
            document.getElementById('feedback').innerHTML = '';
            
            // Reset Teddy's dialogue
            document.getElementById('teddy-dialogue').innerHTML = '<p>You can do this! Click an answer when you\'re ready! üéæ</p>';
        }

        function checkAnswer(selected) {
            const q = questions[currentQuestion];
            const feedback = document.getElementById('feedback');
            const options = document.querySelectorAll('.answer-option');
            
            // Reset hint tracking since they attempted
            hintsWithoutAttempt = 0;
            
            // Disable all options
            options.forEach(opt => opt.disabled = true);
            
            if (selected === q.correct) {
                // Correct!
                options[selected].classList.add('correct');
                feedback.innerHTML = '<div class="correct-feedback">‚ú® Correct! Well done! ‚ú®</div>';
                document.getElementById('teddy-dialogue').innerHTML = '<p>YES! That\'s it! You\'re amazing! Let\'s keep going! üéâ</p>';
                
                // Check if they've earned a pup
                if ((currentQuestion + 1) % 5 === 0 && pupsFound < studyPups.length) {
                    setTimeout(() => foundPup(), 1500);
                } else {
                    setTimeout(nextQuestion, 2000);
                }
            } else {
                // Incorrect
                options[selected].classList.add('incorrect');
                options[q.correct].classList.add('correct');
                feedback.innerHTML = '<div class="incorrect-feedback">Not quite! Have another look at the correct answer.</div>';
                document.getElementById('teddy-dialogue').innerHTML = '<p>That\'s okay! Mistakes help us learn! The correct answer is highlighted. üêï</p>';
                
                setTimeout(nextQuestion, 3000);
            }
        }

        function nextQuestion() {
            currentQuestion++;
            if (currentQuestion < questions.length) {
                loadQuestion();
            } else {
                // All questions done!
                showCompletion();
            }
        }

        function useHint() {
            if (gemCooldown) {
                document.getElementById('teddy-dialogue').innerHTML = '<p>The gem needs a bit more time to recharge! Give it a moment... ‚è≥</p>';
                return;
            }

            const q = questions[currentQuestion];
            document.getElementById('teddy-dialogue').innerHTML = `<p><strong>Teddy's Hint:</strong> ${q.hint}</p>`;
            
            // Track hints without attempts
            hintsWithoutAttempt++;
            if (hintsWithoutAttempt >= 3) {
                suggestBreak();
                hintsWithoutAttempt = 0;
            }
            
            // Use gem energy
            gemEnergy -= 33;
            updateGemEnergy();
            
            if (gemEnergy <= 0) {
                startGemCooldown();
            }
        }

        function updateGemEnergy() {
            const energyFill = document.getElementById('gem-energy');
            energyFill.style.width = gemEnergy + '%';
            
            const gem = document.getElementById('hint-gem');
            if (gemEnergy <= 0) {
                gem.classList.remove('active');
                gem.classList.add('recharging');
            } else {
                gem.classList.add('active');
                gem.classList.remove('recharging');
            }
        }

        function startGemCooldown() {
            gemCooldown = true;
            let rechargTime = 20; // 20 seconds
            
            const interval = setInterval(() => {
                rechargTime--;
                gemEnergy = Math.min(100, gemEnergy + 5);
                updateGemEnergy();
                
                if (rechargTime <= 0) {
                    clearInterval(interval);
                    gemCooldown = false;
                    gemEnergy = 100;
                    updateGemEnergy();
                }
            }, 1000);
        }

        function suggestBreak() {
            document.getElementById('break-modal').classList.add('show');
        }

        function takeBreak() {
            document.getElementById('break-modal').classList.remove('show');
            // Could add a timer here if you want a mandatory break
            document.getElementById('teddy-dialogue').innerHTML = '<p>Good choice! Take your time - I\'ll be here when you get back! üêï</p>';
        }

        function keepGoing() {
            document.getElementById('break-modal').classList.remove('show');
            document.getElementById('teddy-dialogue').innerHTML = '<p>Okay! You\'ve got this! But let me know if you need a break! üéæ</p>';
        }

        function foundPup() {
            const pup = studyPups[pupsFound];
            document.getElementById('pup-avatar').textContent = pup.emoji;
            document.getElementById('pup-greeting').textContent = `You found ${pup.name}!`;
            document.getElementById('pup-intro').innerHTML = `
                Hi! I'm ${pup.name}! I'm a ${pup.type}!<br>
                I'm really good with <strong>${pup.skill}</strong> questions!<br>
                You can call on me anytime you need help with those! üéâ
            `;
            
            // Unlock the pup slot in the collection
            const pupSlot = document.querySelector(`.pup-slot[data-pup="${pupsFound}"]`);
            if (pupSlot) {
                pupSlot.classList.remove('locked');
                pupSlot.classList.add('unlocked');
                pupSlot.querySelector('.pup-silhouette').textContent = pup.emoji;
                pupSlot.querySelector('.pup-name').textContent = pup.name;
            }
            
            pupsFound++;
            document.getElementById('celebration-modal').classList.add('show');
        }

        function continueAdventure() {
            document.getElementById('celebration-modal').classList.remove('show');
            nextQuestion();
        }

        function showCompletion() {
            document.querySelector('.practice-container').innerHTML = `
                <div class="completion-screen">
                    <h1>Amazing Work! üéâ</h1>
                    <div class="teddy-big">üêï‚ú®</div>
                    <p>You completed all the pattern practice!</p>
                    <p>StudyPups found: ${pupsFound}</p>
                    <p class="coming-soon">More adventures coming soon!</p>
                    <button class="game-button" onclick="location.reload()">Practice Again</button>
                    <button class="game-button-secondary" onclick="window.location.href='index.html'">Back to Start</button>
                </div>
            `;
        }

        // Initialize
        window.onload = function() {
            loadQuestion();
            updateGemEnergy();
        };
    </script>
</body>
</html>
